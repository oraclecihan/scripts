select t.*,
                    trunc((min_rcf_create-min_nfd_create)/60) || 'H ' || trunc(mod(min_rcf_create-min_nfd_create,60)) || 'M' as rcf_nfd_duration,
                    trunc((min_rcf_create-min_dlv_create)/60) || 'H ' || trunc(mod(min_rcf_create-min_dlv_create,60)) || 'M' as rcf_dlv_duration,
                    trunc((min_nfd_create-min_dlv_create)/60) || 'H ' || trunc(mod(min_nfd_create-min_dlv_create,60)) || 'M' as nfd_dlv_duration                   
                    from (select awb_prefix,
                    awb_number,
                    type,
                    awb_origin,
                    awb_destination,
                    awb_weight_code,
                    awb_weight aaaa,
                    awb_pieces_part,
                    awb_pieces_total,
                    carrier || flight_number flight,
                    flight_date,
                    fsd_datetime,
                    date_created,
                    remarks_1 || remarks_2 remarks, (
                        SELECT
                            MIN(date_created)
                        FROM
                            lin_awb_statussen
                        WHERE
                            awb_number = t.awb_number
                            AND awb_prefix = t.awb_prefix
                            AND type = 'RCF'
                    ) min_rcf_create,
                     (
                        SELECT
                            MIN(date_created)
                        FROM
                            lin_awb_statussen
                        WHERE
                            awb_number = t.awb_number
                            AND awb_prefix = t.awb_prefix
                            AND type = 'NFD'
                    ) min_nfd_create,
                     (
                        SELECT
                            MIN(date_created)
                        FROM
                            lin_awb_statussen
                        WHERE
                            awb_number = t.awb_number
                            AND awb_prefix = t.awb_prefix
                            AND type = 'DLV'
                    ) min_dlv_create,
                    (
                        SELECT
                            MIN(fsd_datetime)
                        FROM
                            lin_awb_statussen
                        WHERE
                            awb_number = t.awb_number
                            AND awb_prefix = t.awb_prefix
                            AND type = 'RCS'
                    ) min_rcs_fsdate_time, (
                        SELECT
                            Max(fsd_datetime)
                        FROM
                            lin_awb_statussen
                        WHERE
                            awb_number = t.awb_number
                            AND awb_prefix = t.awb_prefix
                            AND type = 'RCS'
                    ) max_rcs_fsdate_time,
                    (
                        SELECT
                            MIN(date_created)
                        FROM
                            lin_awb_statussen
                        WHERE
                            awb_number = t.awb_number
                            AND awb_prefix = t.awb_prefix
                            AND type = 'DEP'
                    ) min_dep_create,
                     (
                        SELECT
                            Max(date_created)
                        FROM
                            lin_awb_statussen
                        WHERE
                            awb_number = t.awb_number
                            AND awb_prefix = t.awb_prefix
                            AND type = 'DEP'
                    ) max_dep_create,
                    (  SELECT
                            carrier || flight_number
                        FROM
                            lin_awb_statussen
                        WHERE
                            awb_number = t.awb_number
                            AND awb_prefix = t.awb_prefix
                            AND type = 'DEP'  and rownum=1) dep_flight,
                        ( SELECT
                            flight_date
                        FROM
                            lin_awb_statussen
                        WHERE
                            awb_number = t.awb_number
                            AND awb_prefix = t.awb_prefix
                            AND type = 'DEP' and rownum=1) dep_flight_date,                            
                    (select mse_sender from lin_messages where mse_id=t.msg_id) mse_sender from lin_awb_statussen t
WHERE
t.date_created >= TO_DATE('01.06.2020', 'dd.mm.yyyy')
AND t.date_created < TO_DATE('15.06.2020', 'dd.mm.yyyy')
--and awb_prefix='999' and awb_number='73827762'
and type IN   ('RCF', 'NFD', 'DLV')
order by date_created ) t